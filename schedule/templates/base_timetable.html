{% load i18n static %}
{% load custom_tags %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="{% if LANGUAGE_BIDI %}rtl{% else %}ltr{% endif %}" xml:lang="{{ LANGUAGE_CODE }}" lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% if site_name %}{{ site_name }} : {% endif %}{% block head_title %}{% endblock %}</title>
        <!--  font  -->
        <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css' rel='stylesheet' type='text/css'>
        <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-jp.css' rel='stylesheet' type='text/css'>
        <link href="https://fonts.googleapis.com/css?family=Noto+Serif+KR:400,500,600&display=swap&subset=korean" rel="stylesheet">
        <!--        -->
        <link rel="stylesheet" href="{% static "bootstrap/dist/css/bootstrap.css" %}" type="text/css" media="screen">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"crossorigin="anonymous">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">
        <link rel='stylesheet' type='text/css' href="{% static 'base.css' %}" />
        <link rel='stylesheet' type='text/css' href="{% static 'calendar.css' %}" />
        <script type="text/javascript" src="{% static "jquery/dist/jquery.js" %}"></script>
        <script type="text/javascript" src="{% static "jquery-ui/jquery-ui.min.js" %}"></script>
        <script type="text/javascript" src="{% static "bootstrap/dist/js/bootstrap.js" %}"></script>
        <script type="text/javascript" src="{% static "schedule.js" %}"></script>
        <link rel="stylesheet" href="{% static "schedule.css" %}" type="text/css" media="screen">
        <link rel="stylesheet" href="{% static "jquery-ui/themes/base/all.css" %}" type="text/css" media="screen">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
        <link rel="shortcut icon" href="{% static 'favicon.png' %}" type="image/x-icon">
        {% block extra_head %}
        {% endblock %}
    </head>

    <body>
        <!--header>
            <div class="navbar-fixed">
                <nav>
                    <ul id="dropdown" class="dropdown-content">
                        {% if user.username == '악의꽃admin' or user.username == '막무간애admin' or user.username == '모여락admin'%}
                            <li><a href="{% url 'stayAwake' %}"><i class="material-icons">brightness_3</i>철야신청</a></li>
                            <li><a href="{% url 'individualTimeSet' %}"><i class="material-icons left">schedule</i>시간설정</a></li>
                            <li><a href="{% url 'Borrow' %}"><i class="material-icons left">reply</i>대여등록</a></li>
                            <li class="divider"></li>
                            <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                            <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비번변경</a></li>
                        {% elif user.username == '악의꽃' or user.username == '막무간애' or user.username == '모여락'%}
                            <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                            <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비번변경</a></li>
                        {% elif user.username == 'admin' %}
                            <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                            <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비번변경</a></li>
                        {% endif %}
                    </ul>
                    <div class="nav-wrapper">
                        <a href="#" data-target="slide-out" class="sidenav-trigger">
                            <i class="material-icons">menu</i>
                        </a>
                        <ul class="right hide-on-med-and-down">
                            {% if user.is_active %}
                            {% block extra_list %}

                            {% endblock %}
                            <li>
                                <a class="dropdown-trigger" href="#!" data-target="dropdown">{{ user.username }}&nbsp; <i class="material-icons right">arrow_drop_down</i></a>
                            </li>
                            {% else %}
                            <li><a href="{% url 'login' %}"><i class="material-icons left">account_circle</i>로그인</a></li>
                            {% endif %}
                        </ul>
                    </div>
                </nav>
            </div>
            <ul class="sidenav" id="slide-out" style="transform: translateX(-100%);">
                <li>
                    <div class="user-view">
                        <div class="background">
                            <img src="https://www.vactualpapers.com/web/wallpapers/colorful-material-design-qhd-wallpaper-15/3500x3500.png">
                        </div>
                        <a href="#!user">
                            <img class="circle" src="{% static 'profile.jpg' %}">
                        </a>
                        <a href="#!name">
                            {% if user.is_active %}
                            <span class="white-text name">{{ user.username }}</span>
                            {% else %}
                            <span class="white-text name">Guest</span>
                            {% endif %}
                        </a>
                        <a href="#!email">
                            <span class="white-text email"></span>
                        </a>
                    </div>
                </li>
                {% if user.username == '악의꽃' or user.username == '악의꽃admin' %}
                    <li><a class="subheader">시간표</a></li>
                    <li><a href="/clubTimetable/"><i class="material-icons left">dashboard</i>악의꽃시간표</a></li>
                    <li><a href="/timetable/"><i class="material-icons left">home</i>전체시간표</a></li>
                {% elif user.username == '막무간애' or user.username == '막무간애admin' %}
                    <li><a href="/clubTimetable/"><i class="material-icons left">dashboard</i>막무간애시간표</a></li>
                    <li><a href="/timetable/"><i class="material-icons left">home</i>전체시간표</a></li>
                {% elif user.username == '모여락' or user.username == '모여락admin' %}
                    <li><a href="/clubTimetable/"><i class="material-icons left">dashboard</i>모여락시간표</a></li>
                    <li><a href="/timetable/"><i class="material-icons left">home</i>전체시간표</a></li>
                {% elif user.username == 'admin' %}
                    <li><a class="subheader">관리자</a></li>
                    <li><a href="{% url 'admin:index' %}"><i class="material-icons left">build</i>관리자페이지</a></li>
                    <li><a href="{% url 'setTime' %}"><i class="material-icons left">schedule</i>시간설정</a></li>
                {% endif %}
                <li class="divider"></li>
                {% if user.username == '악의꽃admin' or user.username == '막무간애admin' or user.username == '모여락admin'%}
                    <li><a class="subheader">철야 및 시간 설정</a></li>
                    <li><a href="{% url 'stayAwake' %}"><i class="material-icons">brightness_3</i>철야신청</a></li>
                    <li><a href="{% url 'individualTimeSet' %}"><i class="material-icons left">schedule</i>시간설정</a></li>
                    <li><a href="{% url 'Borrow' %}"><i class="material-icons left">reply</i>대여등록</a></li>
                    <li class="divider"></li>
                    <li><a class="subheader">계정</a></li>
                    <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                    <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비밀번호 변경</a></li>
                {% elif user.username == '악의꽃' or user.username == '막무간애' or user.username == '모여락'%}
                    <li><a class="subheader">계정</a></li>
                    <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                    <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비밀번호 변경</a></li>
                {% elif user.username == 'admin' %}
                    <li><a class="subheader">계정</a></li>
                    <li><a href="{% url 'logout' %}"><i class="material-icons left">exit_to_app</i>로그아웃</a></li>
                    <li><a href="{% url 'change_password' %}"><i class="material-icons left">vpn_key</i>비번변경</a></li>
                {% endif %}
                {% if not user.is_active %}
                    <li><a href="{% url 'login' %}"><i class="material-icons left">account_circle</i>로그인</a></li>
                {% endif %}
            </ul>
        </header-->
        <main>
            <div id="sidemenu">
                <div class="user-menu">
                    {% if user.is_active %}
                        <h1>
                            {{ user.username }}
                        </h1>
                    {% else %}
                        <h1>
                            어서오세요!
                        </h1>
                    {% endif %}
                </div>
                {% if user.is_active %}
                    <div class="menu-idx1">
                        {% if user|has_group:"users" or request.user|has_group:"admins" %}
                        <div class="menu-btn" onclick="location.href='/clubTimetable'">
                            <h2>
                                {% if user|has_group:"users" %} 
                                <i class="material-icons left">dashboard</i>{{ user.username }}시간표
                                {% elif user|has_group:"admins" %}
                                <i class="material-icons left">dashboard</i>{{ user.username|handle_admin }}시간표
                                {% endif %}
                            </h2>
                        </div>
                        <div class="menu-btn" onclick="location.href='/timetable'">
                            <h2>
                                <i class="material-icons left">home</i>전체시간표
                            </h2>
                        </div>
                        {% else %}
                        <div class="menu-btn" onclick="location.href='/admin'">
                            <h2>
                                <i class="material-icons left">build</i>관리자페이지
                            </h2>
                        </div>
                        <div class="menu-btn" onclick="location.href='/SetTime'">
                            <h2>
                                <i class="material-icons left">schedule</i>시간설정
                            </h2>
                        </div>
                        {% endif %}
                    </div>
                    {% if user|has_group:"admins" %}
                    <div class="menu-idx2">
                        <div class="menu-btn" onclick="location.href='{% url 'stayAwake' %}'">
                            <h2>
                                <i class="material-icons left">brightness_3</i>철야신청
                            </h2>
                        </div>
                        <br/>
                        <div class="menu-btn" onclick="location.href='{% url 'individualTimeSet' %}'">
                            <h2>
                                <i class="material-icons left">schedule</i>시간설정
                            </h2>
                        </div>
                        <div class="menu-btn" onclick="location.href='{% url 'Borrow' %}'">
                            <h2>
                                <i class="material-icons left">reply</i>대여등록
                            </h2>
                        </div>
                    </div>
                    {% endif %}
                    {% if user|has_group:"admins" %}
                    <div class="menu-idx3">
                    {% else %}
                    <div class="menu-idx2">
                    {% endif %}
                        <div class="menu-btn" onclick="location.href='{% url 'logout' %}'">
                            <h2>
                                <i class="material-icons left">exit_to_app</i>로그아웃
                            </h2>
                        </div>
                        <br/>
                        <div class="menu-btn" onclick="location.href='{% url 'change_password' %}'">
                            <h2>
                                <i class="material-icons left">vpn_key</i>비밀번호 변경
                            </h2>
                        </div>
                    </div>
                {% else %}
                <div class="menu-idx1">
                        <div class="menu-btn" onclick="location.href='{% url 'login' %}'">
                            <h2>
                                <i class="material-icons left">account_circle</i>로그인
                            </h2>
                        </div>
                    </div>
                {% endif %}
            </div>
            <div id="calendar">
                {% block body %} {% endblock %}
            </div>
            
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                        var elems = document.querySelectorAll('.sidenav');
                        var instances = M.Sidenav.init(elems);
                    });
                document.addEventListener('DOMContentLoaded', function () {
                        var elems = document.querySelectorAll('.dropdown-trigger');
                        var instances = M.Dropdown.init(elems);
                    });
                $(document).ready(function () {
                    $(".button-collapse").sideNav();
                    $(".collapsible").collapsible();
                    $(".dropdown-trigger").dropdown();
                })
                $(".dropdown-content>li>a").css("color", '#767676');
                
                /* dynamically set calendar options */
                if(calendar) {
                    $(window).resize(function() {
                        var calHeight = $(window).height()*0.9;
                        var height = calHeight < 915 ? calHeight : 915;
                        $('#calendar').fullCalendar('option', 'height', height);
                        if($(window).width() < 950) {
                            var headerJSON = {
                                left: 'hiddenMenu',
                                center: 'title',
                                right: 'agendaWeek,agendaFiveDay prev,next today',
                            };
                            $('#calendar').fullCalendar('option', 'header', headerJSON);
                        }
                        else {
                            headerJSON = {
                                left: 'title',
                                center: '',
                                right: 'prev,next today',
                            }
                            $('#calendar').fullCalendar('option', 'header', headerJSON);
                        }
                    });
                };
            </script>
        </main>
        <!--script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>
</html>
